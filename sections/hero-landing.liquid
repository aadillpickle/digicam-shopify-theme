{%- style -%}
  .hero-landing-section {
    position: relative;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 3rem;
    overflow: hidden;
    background: {{ section.settings.background_color }};
  }

  .hero-landing-section::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 70%;
    height: 60%;
    background: radial-gradient(
      ellipse at bottom left,
      {{ section.settings.gradient_peach }} 0%,
      transparent 70%
    );
    opacity: 0.7;
    pointer-events: none;
  }

  .hero-landing-section::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 60%;
    height: 100%;
    background: radial-gradient(
      ellipse at top right,
      {{ section.settings.gradient_lavender }} 0%,
      transparent 70%
    );
    opacity: 0.7;
    pointer-events: none;
  }

  .hero-cta-wrapper {
    position: absolute;
    left: {{ section.settings.button_horizontal_position }}%;
    top: {{ section.settings.button_vertical_position }}%;
    transform: translateX(-50%);
    z-index: 10;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .hero-cta-arrow {
    width: {{ section.settings.arrow_width }}px;
    height: {{ section.settings.arrow_length }}px;
    stroke: var(--color-text, #1a1a1a);
    stroke-width: 2;
    fill: none;
    margin-top: {{ section.settings.arrow_offset }}px;
    transform: rotate({{ section.settings.arrow_rotation }}deg);
  }

  .hero-cta-wrapper .btn {
    padding: 1.25rem 2.5rem;
    font-size: 1.0625rem;
  }

  #hero-3d-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
  }

  @media (max-width: 768px) {
    .hero-landing-section {
      padding: 1.5rem;
      padding-top: 80px;
      min-height: 100svh;
    }

    .hero-cta-wrapper {
      position: relative;
      left: auto;
      top: auto;
      transform: none;
      margin: 2rem auto;
    }

    .hero-cta-arrow {
      display: none;
    }

    .hero-content {
      text-align: center;
    }

    .hero-headline {
      text-align: center;
    }

    #hero-3d-canvas {
      opacity: 0.7;
    }
  }
{%- endstyle -%}

<section class="hero-landing-section" data-section-id="{{ section.id }}">
  <canvas id="hero-3d-canvas"></canvas>

  <!-- Circular Text Element with Lens -->
  <div class="circular-text-container">
    <svg class="circular-text" viewBox="0 0 150 150">
      <defs>
        <path id="circlePath" d="M 75, 75 m -60, 0 a 60,60 0 1,1 120,0 a 60,60 0 1,1 -120,0"/>
      </defs>
      <text>
        <textPath href="#circlePath">
          {{ section.settings.circular_text | default: 'point and shoot  point and shoot  ' }}
        </textPath>
      </text>
    </svg>
    <div class="circular-lens">
      {%- if section.settings.lens_image != blank -%}
        <img
          src="{{ section.settings.lens_image | image_url: width: 120 }}"
          alt="{{ section.settings.lens_image.alt | default: 'Camera lens' }}"
          width="60"
          height="60"
          loading="eager"
        >
      {%- else -%}
        <img
          src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%231a1a1a'/%3E%3Ccircle cx='50' cy='50' r='35' fill='%23333'/%3E%3Ccircle cx='50' cy='50' r='20' fill='%23555'/%3E%3Ccircle cx='50' cy='50' r='10' fill='%23222'/%3E%3Ccircle cx='40' cy='40' r='5' fill='%23667799' opacity='0.5'/%3E%3C/svg%3E"
          alt="Placeholder: Close-up macro shot of a Lomography camera lens, dark black glass with concentric rings, blue glass reflection highlights, chrome/silver ring around the lens edge, text LOMOGRAPHY 27MM F1.8 engraved on ring, product photography style"
          width="60"
          height="60"
          loading="eager"
        >
      {%- endif -%}
    </div>
  </div>

  <!-- Product Image -->
  <div class="hero-product">
    {%- if section.settings.product_image != blank -%}
      <img
        src="{{ section.settings.product_image | image_url: width: 1200 }}"
        alt="{{ section.settings.product_image.alt | default: 'Mini DigiCam' }}"
        width="600"
        height="600"
        loading="eager"
      >
    {%- else -%}
      <img
        src="{{ 'hero-camera.webp' | asset_url }}"
        alt="Mini DigiCam"
        width="600"
        height="600"
        loading="eager"
      >
    {%- endif -%}
  </div>

  <div class="hero-cta-wrapper">
    {%- liquid
      if section.settings.button_link != blank
        assign button_url = section.settings.button_link
      elsif section.settings.featured_product != blank
        assign button_url = section.settings.featured_product.url
      else
        assign button_url = routes.root_url
      endif
    -%}
    <a href="{{ button_url }}" class="btn btn-primary btn-with-check btn-large">
      {{ section.settings.button_text | default: 'Add to cart' }}
    </a>

    <svg class="hero-cta-arrow" viewBox="0 0 50 {{ section.settings.arrow_length }}" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
      <path d="M 25 {{ section.settings.arrow_length | minus: 5 }} Q 20 {{ section.settings.arrow_length | divided_by: 2 }} 25 15" stroke-linecap="round" fill="none"/>
      <path d="M 18 22 L 25 12 L 32 22" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
    </svg>
  </div>

  <!-- Hero Headline -->
  <div class="hero-content">
    <h1 class="hero-headline">
      <span class="hero-headline-italic">{{ section.settings.headline_line1 | default: 'Mini' }}</span>
      <span>{{ section.settings.headline_line2 | default: 'DigiCam' }}</span>
    </h1>
  </div>
</section>

<script id="hero-3d-settings" type="application/json">
  {
    "sphere1": { "x": {{ section.settings.sphere1_x }}, "y": {{ section.settings.sphere1_y }}, "rotation": {{ section.settings.sphere1_rotation }}, "visible": {{ section.settings.sphere1_visible }} },
    "sphere2": { "x": {{ section.settings.sphere2_x }}, "y": {{ section.settings.sphere2_y }}, "rotation": {{ section.settings.sphere2_rotation }}, "visible": {{ section.settings.sphere2_visible }} },
    "torus": { "x": {{ section.settings.torus_x }}, "y": {{ section.settings.torus_y }}, "rotation": {{ section.settings.torus_rotation }}, "visible": {{ section.settings.torus_visible }} },
    "cone": { "x": {{ section.settings.cone_x }}, "y": {{ section.settings.cone_y }}, "rotation": {{ section.settings.cone_rotation }}, "visible": {{ section.settings.cone_visible }} },
    "spring1": { "x": {{ section.settings.spring1_x }}, "y": {{ section.settings.spring1_y }}, "rotation": {{ section.settings.spring1_rotation }}, "visible": {{ section.settings.spring1_visible }} },
    "spring2": { "x": {{ section.settings.spring2_x }}, "y": {{ section.settings.spring2_y }}, "rotation": {{ section.settings.spring2_rotation }}, "visible": {{ section.settings.spring2_visible }} }
  }
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
(function() {
  const canvas = document.getElementById('hero-3d-canvas');
  if (!canvas) return;

  const settingsEl = document.getElementById('hero-3d-settings');
  const settings = settingsEl ? JSON.parse(settingsEl.textContent) : {};

  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
  camera.position.z = 15;

  const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

  const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
  scene.add(ambientLight);

  const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
  directionalLight.position.set(5, 10, 7);
  scene.add(directionalLight);

  const fillLight = new THREE.DirectionalLight(0xffffff, 0.3);
  fillLight.position.set(-5, -5, 5);
  scene.add(fillLight);

  const whiteMaterial = new THREE.MeshStandardMaterial({
    color: 0xffffff,
    roughness: 0.15,
    metalness: 0.05
  });

  const shapes = [];

  const s1 = settings.sphere1 || { x: 5.5, y: 3.5, rotation: 0, visible: true };
  if (s1.visible) {
    const sphereGeo1 = new THREE.SphereGeometry(0.8, 32, 32);
    const sphere1 = new THREE.Mesh(sphereGeo1, whiteMaterial);
    sphere1.position.set(s1.x, s1.y, 0);
    sphere1.rotation.z = s1.rotation * Math.PI / 180;
    scene.add(sphere1);
    shapes.push({ mesh: sphere1, baseY: s1.y, speed: 0.8, amplitude: 0.3 });
  }

  const s2 = settings.sphere2 || { x: -5.5, y: -3, rotation: 0, visible: true };
  if (s2.visible) {
    const sphereGeo2 = new THREE.SphereGeometry(0.6, 32, 32);
    const sphere2 = new THREE.Mesh(sphereGeo2, whiteMaterial);
    sphere2.position.set(s2.x, s2.y, 0);
    sphere2.rotation.z = s2.rotation * Math.PI / 180;
    scene.add(sphere2);
    shapes.push({ mesh: sphere2, baseY: s2.y, speed: 1.0, amplitude: 0.25 });
  }

  const t = settings.torus || { x: 6, y: 1.5, rotation: 60, visible: true };
  if (t.visible) {
    const torusGeo = new THREE.TorusGeometry(0.6, 0.2, 16, 48);
    const torus = new THREE.Mesh(torusGeo, whiteMaterial);
    torus.position.set(t.x, t.y, 0);
    torus.rotation.x = t.rotation * Math.PI / 180;
    scene.add(torus);
    shapes.push({ mesh: torus, baseY: t.y, speed: 0.7, amplitude: 0.2, rotate: true });
  }

  const c = settings.cone || { x: 4, y: -2.5, rotation: 17, visible: true };
  if (c.visible) {
    const coneGeo = new THREE.ConeGeometry(0.5, 1.2, 32);
    const cone = new THREE.Mesh(coneGeo, whiteMaterial);
    cone.position.set(c.x, c.y, 0);
    cone.rotation.z = c.rotation * Math.PI / 180;
    scene.add(cone);
    shapes.push({ mesh: cone, baseY: c.y, speed: 0.9, amplitude: 0.2, rotate: true });
  }

  function createSpring(x, y, rotation) {
    const springGroup = new THREE.Group();
    const curve = new THREE.CatmullRomCurve3([]);
    const coils = 5;
    const height = 2;
    const radius = 0.3;
    
    for (let i = 0; i <= coils * 20; i++) {
      const ti = i / (coils * 20);
      const angle = ti * coils * Math.PI * 2;
      const px = Math.cos(angle) * radius;
      const py = ti * height - height / 2;
      const pz = Math.sin(angle) * radius;
      curve.points.push(new THREE.Vector3(px, py, pz));
    }
    
    const tubeGeo = new THREE.TubeGeometry(curve, 100, 0.06, 8, false);
    const spring = new THREE.Mesh(tubeGeo, whiteMaterial);
    springGroup.add(spring);
    springGroup.position.set(x, y, 0);
    springGroup.rotation.z = rotation * Math.PI / 180;
    scene.add(springGroup);
    return springGroup;
  }

  const sp1 = settings.spring1 || { x: -5.5, y: 3, rotation: -11, visible: true };
  if (sp1.visible) {
    const spring1 = createSpring(sp1.x, sp1.y, sp1.rotation);
    shapes.push({ mesh: spring1, baseY: sp1.y, speed: 0.6, amplitude: 0.25, rotate: true });
  }

  const sp2 = settings.spring2 || { x: 6.5, y: -1, rotation: 11, visible: true };
  if (sp2.visible) {
    const spring2 = createSpring(sp2.x, sp2.y, sp2.rotation);
    shapes.push({ mesh: spring2, baseY: sp2.y, speed: 0.75, amplitude: 0.2, rotate: true });
  }

  let time = 0;

  function animate() {
    requestAnimationFrame(animate);
    time += 0.016;

    shapes.forEach((shape, i) => {
      shape.mesh.position.y = shape.baseY + Math.sin(time * shape.speed + i) * shape.amplitude;
      if (shape.rotate) {
        shape.mesh.rotation.y += 0.005;
      }
    });

    renderer.render(scene, camera);
  }

  function onResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
    
    const scale = window.innerWidth < 768 ? 0.6 : 1;
    shapes.forEach(shape => {
      shape.mesh.scale.setScalar(scale);
    });
  }

  window.addEventListener('resize', onResize);
  onResize();
  animate();
})();
</script>

{% schema %}
{
  "name": "Hero Landing",
  "tag": "section",
  "class": "hero-landing-wrapper",
  "settings": [
    {
      "type": "header",
      "content": "Headlines"
    },
    {
      "type": "text",
      "id": "headline_line1",
      "label": "Headline line 1 (italic)",
      "default": "Mini"
    },
    {
      "type": "text",
      "id": "headline_line2",
      "label": "Headline line 2",
      "default": "DigiCam"
    },
    {
      "type": "header",
      "content": "Product"
    },
    {
      "type": "product",
      "id": "featured_product",
      "label": "Featured product"
    },
    {
      "type": "image_picker",
      "id": "product_image",
      "label": "Hero product image",
      "info": "Leave empty to use default camera image. Recommended: transparent PNG."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Add to cart"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link",
      "info": "Leave empty to link to the featured product page"
    },
    {
      "type": "header",
      "content": "Button position"
    },
    {
      "type": "range",
      "id": "button_horizontal_position",
      "label": "Horizontal position",
      "info": "0 = left edge, 50 = center, 100 = right edge",
      "min": 10,
      "max": 90,
      "step": 1,
      "default": 28,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "button_vertical_position",
      "label": "Vertical position",
      "info": "0 = top, 50 = middle, 100 = bottom",
      "min": 10,
      "max": 70,
      "step": 1,
      "default": 35,
      "unit": "%"
    },
    {
      "type": "header",
      "content": "Arrow"
    },
    {
      "type": "range",
      "id": "arrow_length",
      "label": "Arrow length",
      "min": 30,
      "max": 120,
      "step": 5,
      "default": 50,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "arrow_width",
      "label": "Arrow width",
      "min": 20,
      "max": 80,
      "step": 5,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "arrow_offset",
      "label": "Arrow spacing from button",
      "min": 0,
      "max": 40,
      "step": 2,
      "default": 8,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "arrow_rotation",
      "label": "Arrow rotation",
      "min": -180,
      "max": 180,
      "step": 5,
      "default": 0,
      "unit": "¬∞"
    },
    {
      "type": "header",
      "content": "üîµ Sphere 1 (top right)"
    },
    {
      "type": "checkbox",
      "id": "sphere1_visible",
      "label": "Show sphere 1",
      "default": true
    },
    {
      "type": "range",
      "id": "sphere1_x",
      "label": "Horizontal position",
      "min": -8,
      "max": 8,
      "step": 0.5,
      "default": 5.5
    },
    {
      "type": "range",
      "id": "sphere1_y",
      "label": "Vertical position",
      "min": -5,
      "max": 5,
      "step": 0.5,
      "default": 3.5
    },
    {
      "type": "range",
      "id": "sphere1_rotation",
      "label": "Rotation",
      "min": -180,
      "max": 180,
      "step": 5,
      "default": 0,
      "unit": "¬∞"
    },
    {
      "type": "header",
      "content": "üîµ Sphere 2 (bottom left)"
    },
    {
      "type": "checkbox",
      "id": "sphere2_visible",
      "label": "Show sphere 2",
      "default": true
    },
    {
      "type": "range",
      "id": "sphere2_x",
      "label": "Horizontal position",
      "min": -8,
      "max": 8,
      "step": 0.5,
      "default": -5.5
    },
    {
      "type": "range",
      "id": "sphere2_y",
      "label": "Vertical position",
      "min": -5,
      "max": 5,
      "step": 0.5,
      "default": -3
    },
    {
      "type": "range",
      "id": "sphere2_rotation",
      "label": "Rotation",
      "min": -180,
      "max": 180,
      "step": 5,
      "default": 0,
      "unit": "¬∞"
    },
    {
      "type": "header",
      "content": "üç© Torus / Donut (right)"
    },
    {
      "type": "checkbox",
      "id": "torus_visible",
      "label": "Show torus",
      "default": true
    },
    {
      "type": "range",
      "id": "torus_x",
      "label": "Horizontal position",
      "min": -8,
      "max": 8,
      "step": 0.5,
      "default": 6
    },
    {
      "type": "range",
      "id": "torus_y",
      "label": "Vertical position",
      "min": -5,
      "max": 5,
      "step": 0.5,
      "default": 1.5
    },
    {
      "type": "range",
      "id": "torus_rotation",
      "label": "Tilt angle",
      "min": 0,
      "max": 180,
      "step": 5,
      "default": 60,
      "unit": "¬∞"
    },
    {
      "type": "header",
      "content": "üî∫ Cone (bottom right)"
    },
    {
      "type": "checkbox",
      "id": "cone_visible",
      "label": "Show cone",
      "default": true
    },
    {
      "type": "range",
      "id": "cone_x",
      "label": "Horizontal position",
      "min": -8,
      "max": 8,
      "step": 0.5,
      "default": 4
    },
    {
      "type": "range",
      "id": "cone_y",
      "label": "Vertical position",
      "min": -5,
      "max": 5,
      "step": 0.5,
      "default": -2.5
    },
    {
      "type": "range",
      "id": "cone_rotation",
      "label": "Tilt angle",
      "min": -90,
      "max": 90,
      "step": 5,
      "default": 17,
      "unit": "¬∞"
    },
    {
      "type": "header",
      "content": "üåÄ Spring 1 (top left)"
    },
    {
      "type": "checkbox",
      "id": "spring1_visible",
      "label": "Show spring 1",
      "default": true
    },
    {
      "type": "range",
      "id": "spring1_x",
      "label": "Horizontal position",
      "min": -8,
      "max": 8,
      "step": 0.5,
      "default": -5.5
    },
    {
      "type": "range",
      "id": "spring1_y",
      "label": "Vertical position",
      "min": -5,
      "max": 5,
      "step": 0.5,
      "default": 3
    },
    {
      "type": "range",
      "id": "spring1_rotation",
      "label": "Tilt angle",
      "min": -90,
      "max": 90,
      "step": 5,
      "default": -11,
      "unit": "¬∞"
    },
    {
      "type": "header",
      "content": "üåÄ Spring 2 (right side)"
    },
    {
      "type": "checkbox",
      "id": "spring2_visible",
      "label": "Show spring 2",
      "default": true
    },
    {
      "type": "range",
      "id": "spring2_x",
      "label": "Horizontal position",
      "min": -8,
      "max": 8,
      "step": 0.5,
      "default": 6.5
    },
    {
      "type": "range",
      "id": "spring2_y",
      "label": "Vertical position",
      "min": -5,
      "max": 5,
      "step": 0.5,
      "default": -1
    },
    {
      "type": "range",
      "id": "spring2_rotation",
      "label": "Tilt angle",
      "min": -90,
      "max": 90,
      "step": 5,
      "default": 11,
      "unit": "¬∞"
    },
    {
      "type": "header",
      "content": "Circular element"
    },
    {
      "type": "text",
      "id": "circular_text",
      "label": "Circular text",
      "default": "point and shoot  point and shoot  "
    },
    {
      "type": "image_picker",
      "id": "lens_image",
      "label": "Lens image"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#FDF8F3"
    },
    {
      "type": "color",
      "id": "gradient_lavender",
      "label": "Gradient lavender",
      "default": "#E8E0F0"
    },
    {
      "type": "color",
      "id": "gradient_peach",
      "label": "Gradient peach",
      "default": "#FFDAB3"
    }
  ],
  "presets": [
    {
      "name": "Hero Landing"
    }
  ]
}
{% endschema %}
